"use strict";const n=require("electron"),d=require("fs/promises"),c=require("path"),u=require("url");var r=typeof document<"u"?document.currentScript:null;const h=u.fileURLToPath(typeof document>"u"?require("url").pathToFileURL(__filename).href:r&&r.tagName.toUpperCase()==="SCRIPT"&&r.src||new URL("main.cjs",document.baseURI).href),w=c.dirname(h);let e=null;async function f(){e=new n.BrowserWindow({width:900,height:700,frame:!1,webPreferences:{preload:c.join(w,"../preload/index.js"),contextIsolation:!0,nodeIntegration:!1,webSecurity:!0}}),e.webContents.setWindowOpenHandler(({url:o})=>(n.shell.openExternal(o),{action:"deny"})),e.webContents.on("devtools-opened",()=>{e?.webContents.send("devtools-state-changed",!0)}),e.webContents.on("devtools-closed",()=>{e?.webContents.send("devtools-state-changed",!1)}),await e.loadFile(c.join(w,"../renderer/main_window/index.html"))}n.app.whenReady().then(async()=>{n.session.defaultSession.setPermissionRequestHandler((o,t,i)=>{i(!1)}),n.session.defaultSession.webRequest.onHeadersReceived((o,t)=>{t({responseHeaders:{...o.responseHeaders,"Content-Security-Policy":["default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self' ws: wss:;"]}})}),await f(),n.app.on("activate",()=>{n.BrowserWindow.getAllWindows().length===0&&f()})});n.app.on("window-all-closed",()=>{process.platform!=="darwin"&&n.app.quit()});n.ipcMain.handle("window:minimize",()=>{e&&e.minimize()});n.ipcMain.handle("window:toggle-maximize",()=>{e&&(e.isMaximized()?e.unmaximize():e.maximize())});n.ipcMain.handle("window:close",()=>{e&&e.close()});n.ipcMain.handle("window:reload",()=>{e&&e.reload()});n.ipcMain.handle("window:toggle-devtools",()=>{e&&(e.webContents.isDevToolsOpened()?e.webContents.closeDevTools():e.webContents.openDevTools({mode:"detach"}))});n.ipcMain.handle("window:is-devtools-open",()=>e?e.webContents.isDevToolsOpened():!1);n.ipcMain.handle("window:force-reload",()=>{e&&e.webContents.reloadIgnoringCache()});n.ipcMain.handle("window:toggle-fullscreen",()=>{e&&e.setFullScreen(!e.isFullScreen())});n.ipcMain.handle("window:zoom-reset",()=>{e&&(e.webContents.setZoomFactor(1),e.webContents.send("zoom-changed",1))});n.ipcMain.handle("window:get-zoom-level",()=>e?e.webContents.getZoomFactor():1);n.ipcMain.handle("window:zoom-in",()=>{if(e){const o=e.webContents.getZoomFactor(),t=Math.min(3,Math.round((o+.1)*10)/10);e.webContents.setZoomFactor(t),e.webContents.send("zoom-changed",t)}});n.ipcMain.handle("window:zoom-out",()=>{if(e){const o=e.webContents.getZoomFactor(),t=Math.max(.3,Math.round((o-.1)*10)/10);e.webContents.setZoomFactor(t),e.webContents.send("zoom-changed",t)}});n.ipcMain.handle("file:open",async()=>{if(!e)return{canceled:!0};const o=await n.dialog.showOpenDialog(e,{properties:["openFile"],filters:[{name:"Text Files",extensions:["txt","md","log"]},{name:"All Files",extensions:["*"]}]});if(o.canceled||o.filePaths.length===0)return{canceled:!0};const t=o.filePaths[0],i=await d.readFile(t,"utf8");return{canceled:!1,path:t,content:i}});n.ipcMain.handle("file:save",async(o,t)=>{if(!e)return{canceled:!0};const{path:i,content:a}=t??{};let s=i;if(!s){const l=await n.dialog.showSaveDialog(e,{filters:[{name:"Text Files",extensions:["txt"]},{name:"All Files",extensions:["*"]}]});if(l.canceled||!l.filePath)return{canceled:!0};s=l.filePath}return await d.writeFile(s,a,"utf8"),{canceled:!1,path:s}});n.ipcMain.handle("file:save-as",async(o,t)=>{if(!e)return{canceled:!0};const{content:i}=t??{},a=await n.dialog.showSaveDialog(e,{filters:[{name:"Text Files",extensions:["txt"]},{name:"All Files",extensions:["*"]}]});return a.canceled||!a.filePath?{canceled:!0}:(await d.writeFile(a.filePath,i,"utf8"),{canceled:!1,path:a.filePath})});
//# sourceMappingURL=main.cjs.map
